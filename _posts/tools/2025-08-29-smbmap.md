---
title:  "Enumeration Tool: SMBMap, enum4linux"
excerpt: "SMBMap와 enum4linux 에 대해 자세히 공부해보자."

categories: tools
tags:
  - [metasploit, Msfvenom]

typora-root-url: ../../
 
date: 2025-08-28
last_modified_at: 2025-08-28
---

# SMBMap
SMBMap은 **SMB(Samba) 서버의 공유 폴더와 권한을 탐지·분석하는 도구**이다. 네트워크 취약점 진단이나 모의 해킹 환경 사용된다.

***

## SMBMap 개요
- **역할:** SMB 서버 내 공유 폴더, 읽기/쓰기 권한, 파일 및 디렉토리 존재 여부를 스캔
- **주요 기능:** 목록 조회, 권한 파악, 파일 다운로드·업로드, 패턴 검색, 원격 명령 실행 등

***

## 설치 방법

```bash
sudo apt install smbmap
```


***

## 기본 사용법

```bash
sudo smbmap -H <타깃IP>
```
- 자체 인증 정보 없이 널 세션(NULL Session) 테스트도 가능하다.

```bash
sudo smbmap -H <타깃IP> -u '<계정명>' -p '<패스워드>'
```
- 계정 명과 패스워드 없이도 접근 가능할 때가 있음. 비워놓아도 작동한다.

***

## 주요 플래그 및 옵션

| 옵션 | 설명                               |
|------|-------------------------------------|
| -h   | 도움말 표시                         |
| -H   | 대상(호스트) IP 지정                |
| -P   | 포트 지정(기본 445)                 |
| -u   | 사용자명 지정                       |
| -p   | 비밀번호 지정                       |
| -d   | 도메인 지정                         |
| -R   | 공유 폴더 내 파일/폴더 전체 목록    |
| --dir-only | 폴더만 목록 출력             |
| -r   | 재시도 횟수 지정                    |
| -t   | 네트워크 타임아웃 지정              |
| -o   | 결과 출력 파일 지정                 |

예시:
```bash
sudo smbmap -H 192.168.0.10 -u 'guest' -p ''
```


파일 내보내기:
```bash
sudo smbmap -H 192.168.0.10 -R share -A '.txt'
```
- 특정 패턴(.txt)만 자동 다운로드

***

## 실전 활용 예시

- **공유 폴더 확인:**
  ```bash
  sudo smbmap -H 192.168.0.10
  ```
- **특정 파일만 다운:**
  ```bash
  sudo smbmap -H 192.168.0.10 -R share -A '.docx'
  ```
- **권한 탐지 & 취약점 진단에 활용:**
  SMBMap은 널 세션(NTLM 인증 없이)로도 동작할 수 있어 SMB의 잘못된 권한 설정을 손쉽게 파악할 수 있다.

***

이 외에도 `sudo smbmap -h` 명령으로, 상세 플래그와 세부 사용 설명을 확인할 수 있다.



# enum4linux
## 개요
enum4linux는 **Windows 또는 Samba 서버의 사용자·그룹·공유 폴더 등 다양한 정보를 자동으로 수집(열거)하는 리눅스 도구**이다. 모의해킹과 취약점 진단에서 SMB(NetBIOS) 서비스 정보 수집 단계에 활용된다.

***

## 주요 특징
- 윈도우/삼바 서버의 시스템·사용자·그룹·공유폴더·패스워드 정책 정보를 빠르게 탐지
- smbclient, rpcclient, net, nmblookup 등 SMB 기본 도구들을 이용하는 Perl 스크립트 기반
- 널 세션(NULL session) 또는 특정 계정 인증 방식 모두 지원

***

## 설치 방법

```bash
sudo apt install enum4linux
```


***

## 기본 사용법

가장 단순한 사용법:
```bash
sudo enum4linux [타깃IP]
```
- 모든 주요 옵션을 자동 실행:
```bash
sudo enum4linux -a [타깃IP]
```


***

## 주요 옵션(플래그)

| 옵션         | 설명                                            |
|--------------|-------------------------------------------------|
| -h           | 도움말 출력                                     |
| -a           | 모든 주요 열거 옵션 자동 수행                    |
| -U           | 사용자 리스트                                   |
| -G           | 그룹 및 그룹원 리스트                            |
| -S           | 공유 폴더 리스트                                |
| -o           | 운영체제 정보                                   |
| -P           | 패스워드 정책 정보                              |
| -u [ID]      | 인증 계정 ID 지정                               |
| -p [PW]      | 인증 패스워드 지정                              |
| -d [도메인]  | 도메인 지정                                     |
| -r           | RID 사이클(익명 사용자를 통한 계정 추출)         |
| -R [범위]    | RID 범위 지정해 계정 탐색                       |
| -M           | 머신(컴퓨터) 목록                               |
| -d           | 자세한 출력(detailed)                           |
| -o           | 결과 파일로 출력                                |

***

## 실전 예시

- **전체 정보 열거(가장 많이 사용하는 방식):**
  ```bash
  sudo enum4linux -a 10.10.10.5
  ```
- **사용자 리스트만 추출:**
  ```bash
  sudo enum4linux -U 192.168.1.100
  ```
- **인증정보 지정해서 공유 폴더 리스트 확인:**
  ```bash
  sudo enum4linux -u administrator -p password -S 10.0.0.7
  ```
- **패스워드 정책 정보 확인:**
  ```bash
  sudo enum4linux -P 192.168.56.1
  ```


***

## 활용 포인트

- 익명 로그인 허용 SMB 서버에서 유저 이름 등 민감 정보 쉽게 수집
- 취약한 공유 폴더, 무방비 계정, 권한 오용 등을 실시간으로 확인 가능
- 상세 정보를 한 번에 열람해 후속 공격(Brute-force, 패스워드 크래킹, 권한상승)에 활용
